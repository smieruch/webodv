$(document).ready(function(){var upload_file_size=0;var file_name="";var delete_path_name="";window.add_download_delete_treeview=function(){var lis=$(".hummingbird-end-node").parent("label").parent("li");$.each(lis,function(i,e){if(pager_num!=disable_treeview_delete){$(this).append(' <i class="fa fa-download"></i> <i class="fa fa-trash"></i>')}else{$(this).append(' <i class="fa fa-download"></i>')}});$(".fa-download").on("click",function(){console.log("download");download_collection($(this))});if(pager_num>1){$(".fa-trash").on("click",function(){console.log("trash");$("#delete_collection").text($(this).siblings("label").text());delete_path_name=$(this).siblings("label").children("input").attr("data-id");$("#trashModal").modal("show")})}};$("#delete_collection_yes").on("click",function(){$("#treeview").hummingbird("removeNode",{attr:"data-id",name:'"'+delete_path_name+'"'});var groups=$("#treeview").find('input:checkbox:not(".hummingbird-end-node")');$.each(groups,function(i,e){var num_end_nodes=$(this).parent("label").parent("li").find("input:checkbox.hummingbird-end-node").length;if(num_end_nodes==0){$(this).parent("label").parent("li").remove();console.log($(this))}});$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+http_port+"/webodv/delete_collection",data:{filepathname:delete_path_name},cache:"false",func:"delete_collection",error:function(data){},success:function(data){}})});$(document).ajaxComplete(function(e,xhr,settings){if(settings.func=="delete_collection"){}if(settings.func=="download_collection"){responseText=JSON.parse(xhr.responseText);$.unblockUI();$("#download_collection").attr("href",responseText.url);$("#start_download").trigger("click")}});function download_collection(download_icon){var filepathname=download_icon.siblings("label").children("input").attr("data-id");$.blockUI({message:'<h1><i class="fa fa-refresh fa-spin fa-fw"></i> Processing download, please wait. </h1>'});$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+http_port+"/webodv/download_collection",data:{filepathname:filepathname},cache:"false",func:"download_collection",error:function(data){},success:function(data){}})}if(localStorage.getItem("awiModalneveragain")===null){$("#awiModal").modal("show")}var awiModalneveragain=$("#awiModal").find("#awiModalneveragain");awiModalneveragain.on("click",function(){localStorage.setItem("awiModalneveragain",true)})});