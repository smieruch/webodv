var pager_num=1;if(typeof index_page!="undefined"){if(index_page=="TRUE"){if(typeof localStorage.getItem("pager_num")!="undefined"){if(localStorage.getItem("pager_num")!=null){var pager_num=localStorage.getItem("pager_num")}}}}$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var loading_snippet='<div class="loading_snippet"><h1><i class="fa fa-refresh fa-spin fa-fw"></i> Loading </h1></div>';var progress_snippet='<div class="progress" style="height:40px;">'+'<div class="progress-bar bg-info" role="progressbar" aria-valuenow="0"'+'aria-valuemin="0" aria-valuemax="100" style="width:0%;height:40px;font-size:18px;" id="progress">0 %</div>'+"</div>";$(".create_treeview_from_folder").append(loading_snippet);window.create_treeview_from_folder_function=function(){if(typeof create_treeview_from_folder_ajax_url!="undefined"){$(".loading_snippet").show();$("#upload").prop("disabled",true).css("cursor","not-allowed");console.log("create_treeview_from_folder !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11");$.ajax({type:"POST",url:create_treeview_from_folder_ajax_url,data:{pager_num:pager_num},dataType:"json",cache:"false",func:"create_treeview_from_folder_ajax",error:function(data){console.log("ERROR")},success:function(data){console.log("SUCCESS 123")}})}};create_treeview_from_folder_function();var isInIFrame=window.location!=window.parent.location;if(isInIFrame==true){var odvonline_iframe=$(parent.document).find("#odvonline_iframe");window.parent.location=window.location.protocol+"//"+window.location.hostname;odvonline_iframe.remove()}else{}function set_window_height_core(){var page_height=$(document).height();var copyright_div_height=$("#copyright_div").height();var diff=Number(page_height)-Number(copyright_div_height);$("#copyright_div").offset({top:diff})}if(typeof wsUri=="undefined"){$(window).resize(function(){set_window_height_core()});set_window_height_core()}if(typeof localStorage.getItem("hide_top_bar")!="undefined"){if(localStorage.getItem("hide_top_bar")=="none"){$(".webodv_top_nav").hide()}else{$(".webodv_top_nav").show()}}else{}$("#hide_top_bar").on("click",function(){$(".webodv_top_nav").toggle();localStorage.setItem("hide_top_bar",$(".webodv_top_nav").css("display"))});if(typeof user_allowed_wsodv!="undefined"){if(!user_allowed_wsodv){$("#wsodv_allowModal").modal("show")}}if(typeof http_port!="undefined"){$.ajax({type:"GET",url:window.location.protocol+"//"+window.location.hostname+http_port+"/tracking",func:"trackingSUCCESS",cache:"false",error:function(data){console.log("tracking ERROR!!!!!!!!!!!!!")},success:function(data){console.log("tracking SUCCESS!!!!!!!!!!!!!")}})}if(typeof localStorage.getItem("cookies_help_not_show_again")!="undefined"){if(localStorage.getItem("cookies_help_not_show_again")===null){$("#cookies_help_modal").modal("show")}}else{$("#cookies_help_modal").modal("show")}var cookies_help_not_show_again=$("#cookies_help_modal").find("#cookies_help_not_show_again");$("#cookies_help_modal").on("shown.bs.modal",function(){$("#cookies_help_not_show_again").on("click",function(){console.log("set cookies");localStorage.setItem("cookies_help_not_show_again",true)})});$("#legal,.impressum_a").on("click",function(e){e.preventDefault();$("#legalmodal").modal("show")});$("#privacy,#privacy_from_cookie_modal,#privacy_from_register,.privacy_a").on("click",function(e){e.preventDefault();$("#privacymodal").modal("show")});$(".geotraces_link").on("click",function(e){e.preventDefault();$("#"+$(this).attr("id")+"_modal").modal("show")});$("#sextantURL_a").on("click",function(e){e.preventDefault();$("#sextant_modal").modal("show")});var Contact={name:"",email:"",message:""};var sentSUCCESS=false;var mailSent=false;$("#contact_a").on("click",function(e){e.preventDefault();$("#contact_modal").modal("show")});$("#contact_button_send").on("click",function(){Contact.name=$("#contact_name").val();Contact.email=$("#contact_email").val();Contact.message=$("#contact_message").val();var allow_send=0;var error_text="Please fill out this field.";$.each(Contact,function(i,e){if(e.replace(/\s/g,"")==""){$("#contact_"+i+"_error").text(error_text);allow_send=0}else{$("#contact_"+i+"_error").text("");allow_send++}});var patt=/\S+@\S+\.\S+/;if(Contact.email.replace(/\s/g,"")!=""){if(patt.test(Contact.email)==false){$("#contact_email_error").text("Please enter a valid E-Mail address.");allow_send=0}}if(allow_send==3){mailSent=true;processing=true;$(this).prop("disabled",true).css("cursor","not-allowed");$("#contact_sentSUCCESS").html('<i class="fa fa-refresh fa-spin fa-fw"></i> Please wait, we are now sending your message.');sendContact()}});function sendContact(){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+http_port+"/contact",data:Contact,dataType:"json",func:"showSUCCESS",cache:"false",error:function(data){sentSUCCESS=false},success:function(data){sentSUCCESS=true}})}$(document).ajaxComplete(function(e,xhr,settings){if(settings.func=="showSUCCESS"){if(sentSUCCESS==true){$("#contact_sentSUCCESS").text("Your email has been sent successfully.")}else{$("#contact_sentSUCCESS").text("Sorry, your email could not been sent.")}}if(settings.func=="create_treeview_from_folder_ajax"){responseText=JSON.parse(xhr.responseText);$("#upload").prop("disabled",false).css("cursor","pointer");$("#treeview_container").remove();$(".create_treeview_from_folder").append(responseText);$(".hummingbird-treeview-converter").hide();init_index_treeview()}if(settings.func=="showSUCCESSprofile"){responseText=JSON.parse(xhr.responseText);Profile_init=responseText;$("#sentSUCCESSprofile").text("Your profile has been updated successfully.")}if(settings.func=="showSUCCESSdelete"){responseText=JSON.parse(xhr.responseText);if(responseText=="true"){$("#delete_account_sentSUCCESS").html("Your webODV account has been deleted and we logged you out from this session.");setTimeout(function(){window.location=window.location.protocol+"//"+window.location.hostname+http_port},4e3)}else{$("#delete_account_sentSUCCESS").html("Sorry. your account could not be deleted.");$("#delete_account_yes_button").prop("disabled",false).css("cursor","pointer")}}});$("#contact_modal").on("hidden.bs.modal",function(){sentSUCCESS=false;$.each(Contact,function(i,e){$("#contact_"+i+"_error").text("")});$("#contact_message").val("");$("#contact_button_send").prop("disabled",false).css("cursor","pointer");$("#contact_sentSUCCESS").text("")});var Profile_mailSent=false;var Profile_init={institution:"",street:"",city:"",zipcode:"",country:""};var Profile={institution:"",street:"",city:"",zipcode:"",country:""};var Profile_Passw_Mode="Profile";var sentSUCCESSprofile=false;var ProfileAnswer={};Profile_init.institution=$("#institution").val();Profile_init.street=$("#street").val();Profile_init.city=$("#city").val();Profile_init.zipcode=$("#zipcode").val();Profile_init.country=$("#country").val();$("#profile_a").on("click",function(e){e.preventDefault();$("#profile_modal").modal("show")});$("#delete_account").on("click",function(e){e.preventDefault();$("#profile_modal").modal("hide");$("#delete_account_modal").modal("show")});$("#profile_button_send").on("click",function(){$("#sentSUCCESSprofile").html("");Profile.institution=$("#institution").val();Profile.street=$("#street").val();Profile.city=$("#city").val();Profile.zipcode=$("#zipcode").val();Profile.country=$("#country").val();var allow_send=0;var error_text="Please fill out this field.";var alphanumeric="Please use only these characters and numbers (a-zA-Z_@-.0-9) and whitespace.";$.each(Profile,function(i,e){if(e.replace(/\s/g,"")==""){$("#"+i+"_error").text(error_text);allow_send=0}else{if(/[^a-zA-Z0-9\-\_\@\. ]/.test(e)){$("#"+i+"_error").text(alphanumeric);allow_send=0}else{$("#"+i+"_error").text("");allow_send++}}});if(allow_send==5){Profile_mailSent=true;processing=true;$("#profile_button_send").prop("disabled",true).css("cursor","not-allowed");$("#delete_account").prop("disabled",true).css("cursor","not-allowed");$("#sentSUCCESSprofile").html('<i class="fa fa-refresh fa-spin fa-fw"></i> Please wait, we are now updating your profile.');sendProfile()}else{$("#sentSUCCESSprofile").html('<span style="color:#a94442"><br>Your profile could not be updated, check errors above.</span>')}});$("#profile_modal").on("hidden.bs.modal",function(){$.each(Profile_init,function(i,e){$("#"+i+"_error").text("");$("#"+i).val(e)});$("#profile_button_send").prop("disabled",false).css("cursor","pointer");$("#delete_account").prop("disabled",false).css("cursor","pointer");$("#sentSUCCESSprofile").text("")});function sendProfile(){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+http_port+"/webodv/change/profile",data:Profile,dataType:"json",func:"showSUCCESSprofile",cache:"false",error:function(data){sentSUCCESSprofile=false;console.log("receiveProfile ERROR!!!!!!!!!!!!!")},success:function(data){sentSUCCESSprofile=true;console.log("receiveProfile SUCCESS!!!!!!!!!!!!!");ProfileAnswer=data}})}var delete_passwd="";$("#delete_account_yes_button").on("click",function(){delete_passwd=$("#delete_account_password").val();if(delete_passwd.replace(/\s/g,"")==""){$("#delete_account_password_error").text("Please fill out this field.")}else{$("#delete_account_password_error").text("");$(this).prop("disabled",true).css("cursor","not-allowed");$("#delete_account_sentSUCCESS").html('<i class="fa fa-refresh fa-spin fa-fw"></i> Please wait, we are now deleting your profile.');deleteAccount()}});$("#delete_account_modal").on("hidden.bs.modal",function(){$("#delete_account_yes_button").prop("disabled",false).css("cursor","pointer");$("#delete_account_sentSUCCESS").text("");$("#delete_account_password_error").text("");$("#delete_account_password").val("")});function deleteAccount(){$.ajax({type:"POST",url:window.location.protocol+"//"+window.location.hostname+http_port+"/webodv/delete/account",data:{password:delete_passwd},dataType:"json",func:"showSUCCESSdelete",cache:"false",error:function(data){},success:function(data){}})}function init_index_treeview(){$.getScript(hummingbird_treeview_js_path).done(function(){$.getScript(hummingbird_treeview_options_path).done(function(){$(document).ready(function(){var List={id:[],dataid:[],text:[]};$("#treeview").hummingbird();if(typeof add_download_delete_treeview==="function"){add_download_delete_treeview()}if(typeof treeview_jump!="undefined"){$("#treeview").hummingbird("expandNode",{sel:"data-id",vals:[treeview_jump]})}$("#treeview").hummingbird("search",{treeview_container:"treeview_container",search_input:"search_input",search_output:"search_output",search_button:"search_button",scrollOffset:-250,onlyEndNodes:false});var againChecking=false;$("#treeview").on("CheckUncheckDone",function(){console.log("CheckUncheckDone");if(againChecking==true){return}if(List.id!=""){againChecking=true;$.each(List.id,function(i,e){$("#treeview").hummingbird("uncheckNode",{attr:"id",name:'"'+e+'"',collapseChildren:false})});againChecking=false}List={id:[],dataid:[],text:[]};$("#treeview").hummingbird("getChecked",{list:List,onlyEndNodes:true});var file_path_name=String(List.dataid).replace(/\//g,">");window.location=continue_url+"/"+file_path_name.replace(".odv","")});$(".loading_snippet").hide();if($(".hummingbird-base").html()==""){$(".create_treeview_from_folder").append('<div class="loading_snippet" style="width:360px;height:120px"><h1><i class="fa fa-cog fa-spin fa-fw"></i> No .odv files found ! </h1></div>')}})})})}$("#treeview_card_body").show();$(".start_service_button").on("click",function(){$.blockUI({message:'<h1><i class="fa fa-refresh fa-spin fa-fw"></i> Loading </h1>'})});$("#delete").on("click",function(){});$("#upload").on("click",function(){$("#uploadModal2").modal("show")});$("#upload_modal_button").on("click",function(){$("#upload_form").submit()});$("#upload_form").on("submit",function(e){e.preventDefault();var formData=new FormData($(this)[0]);$.ajax({type:"POST",url:$("#upload_form").attr("action"),data:formData,cache:"false",contentType:false,enctype:"multipart/form-data",processData:false,func:"uploading_done",error:function(data){},success:function(data){}})});$(".custom-file-input").on("change",function(){if(typeof $(this)[0].files[0].name!="undefined"){var fileName=$(this)[0].files[0].name;$(this).siblings(".custom-file-label").addClass("selected").html(fileName)}});$(document).ajaxComplete(function(e,xhr,settings){if(settings.func=="uploading_done"){$(".loading_snippet").hide();$("#uploadModal2").modal("show")}if(settings.func=="uploading_done2"){$.unblockUI();$(".progress").hide();create_treeview_from_folder_function()}});$("#upload_modal_button2").on("click",function(){$("#upload_form2").submit()});$("#upload_form2").on("submit",function(e){$.blockUI({message:'<h1 id="uploading_anim"><i class="fa fa-refresh fa-spin fa-fw"></i> Uploading </h1>'+progress_snippet});e.preventDefault();var files=$("#fileToUpload2");var files=files[0].files;var formData=new FormData;$.each(files,function(i,e){formData.append("fileToUpload[]",e,e.name);formData.append("filePaths[]",e.webkitRelativePath)});$.ajax({xhr:function(){var xhr=new window.XMLHttpRequest;xhr.upload.addEventListener("progress",function(element){if(element.lengthComputable){var percentComplete=element.loaded/element.total*100;$("#progress").css("width",Math.round(percentComplete).toString()+"%");$("#progress").text(Math.round(percentComplete).toString()+"%");if(percentComplete>=100){$("#uploading_anim").html('<i class="fa fa-refresh fa-spin fa-fw"></i> Processing, please wait a few seconds!')}}},false);return xhr},type:"POST",url:$("#upload_form2").attr("action"),data:formData,cache:"false",contentType:false,enctype:"multipart/form-data",processData:false,func:"uploading_done2",error:function(data){},success:function(data){}})});$("#select_country").on("changed.bs.select",function(){var title=$(this).siblings("button").prop("title");if(title=="Nothing selected"){title=""}$("#register_country").val(title)});$("#select_country_profile").on("changed.bs.select",function(){var title=$(this).siblings("button").prop("title");if(title=="Nothing selected"){title=""}$("#country").val(title)});$("#pager_large_"+pager_num+",#pager_small_"+pager_num).addClass("active");activate_pager=function(){$(".page-item").removeClass("active");if(pager_num<1){pager_num=1}if(pager_num>number_of_pages){pager_num=number_of_pages}$("#pager_large_"+pager_num.toString()+",#pager_small_"+pager_num.toString()).addClass("active");create_treeview_from_folder_function();if(pager_num>1){$("#upload_div").show()}else{$("#upload_div").hide()}localStorage.setItem("pager_num",pager_num)};$(".webodv_pager").on("click",function(){pager_num=Number($(this).attr("id").substring(12,13));activate_pager()});$(".webodv_pager_left").on("click",function(){pager_num--;activate_pager()});$(".webodv_pager_right").on("click",function(){pager_num++;activate_pager()});$(".priv_workspace").on("click",function(){var name=$(this).parent("td").text();console.log(name);$.ajax({type:"POST",url:remove_project_url,data:{name:name},dataType:"json",cache:"false",func:"remove_project_ajax_done",error:function(data){},success:function(data){}})});$(document).ajaxComplete(function(e,xhr,settings){if(settings.func=="remove_project_ajax_done"){responseText=JSON.parse(xhr.responseText);location.href=responseText.add_project_url}})});